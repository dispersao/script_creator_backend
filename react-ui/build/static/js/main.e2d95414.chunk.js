(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(e,t,n){e.exports=n(259)},257:function(e,t,n){},259:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(24),i=n(20),u=n(99),s=(n(118),n(18)),o=n(11),l=n(12),p=new l.b.Entity("characters"),d=new l.b.Entity("locations"),m=new l.b.Entity("types"),f=new l.b.Entity("parts",{characters:[p]}),E=[new l.b.Entity("sequences",{location:d,type:m,parts:[f]})],g=[new l.b.Entity("scripts",{})],h=function(e){return Object(l.a)(e,g)},v=n(55),b=function(e){return e.sequenceData.get("sequences")},S=function(e){return e.sequenceData.get("parts")},y=function(e){return e.sequenceData.get("characters")},O=function(e){return e.sequenceData.get("locations")},j=function(e){return e.sequenceData.get("types")},C=function(e){return e.scriptData.get("scripts")},q=function(e){return e.scriptData.get("currentScript")},N=function(e){return e.scriptData.get("scriptSequences")},T=function(e,t){return e.sequenceData.get(t)},D=function(e,t){return e.sequenceFilters.get(t)},k=Object(v.a)(function(e,t){var n=e.get("parts").map(function(e){return t.get(e.toString()).get("characters")});return(n=n.flatMap(function(e){return e.valueSeq().toArray()})).toSet().toList()},function(e){return e}),I=Object(v.a)(b,S,y,O,j,function(e){return e.sequenceFilters},C,q,N,function(e,t,n,r,a,c,i,u,s){return e&&0!==e.size?e.sort(function(e,t){return e.get("id")<t.get("id")?-1:e.get("id")>t.get("id")?1:0}).filter(function(e){return c.keySeq().toArray().every(function(n){var r;switch(n){case"characters":r=k(e,t);break;case"locations":r=[e.get("location")];break;case"types":r=[e.get("type")]}return r&&x(c.get(n),r)})&&!i.getIn([u.toString(),"sequences"]).some(function(t){return t===e.get("id")})}).map(function(e){return R(e,a,r,t,n)}).valueSeq().toList():null}),_=Object(v.a)(q,C,N,b,S,y,O,j,function(e,t,n,r,a,c,i,u){if(!e||!t||!r||0===r.size)return null;var s=t.get(e.toString());return Object(o.c)({name:s.get("name"),id:s.get("id"),author:s.get("author"),sequences:s.get("sequences").map(function(e,t){var n=r.get(e.toString());return R(n,u,i,a,c)})})}),R=function(e,t,n,r,a){return Object(o.c)({id:e.get("id"),type:t.get(e.get("type").toString()),location:n.get(e.get("location").toString()),characters:k(e,r).map(function(e){return a.get(e.toString())}),parts:e.get("parts").map(function(e){var t=r.get(e.toString()),n=t.get("characters").map(function(e){return a.get(e.toString())});return t.set("characters",n)})})},x=function(e,t){var n=e.get("ids");if(!n.size)return!0;var r=!0;return r=e.get("and")?n.every(function(e){return t.includes(e)}):n.some(function(e){return t.includes(e)}),e.get("exclude")&&(r=!r),r},w=function(e,t,n){return{type:"CHANGE_SCRIPT_DATA",payload:{script:e,field:t,value:n}}},A=function(e){return function(e,t){if(!(n=t()).sequenceData.getIn(["loading","scripts"])&&!C(n))return e(function(e){return e({type:"REQUEST_SCRIPTS"}),fetch("/scripts",{headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){return console.log(h(t.data)),e({type:"RECEIVE_SCRIPTS",payload:h(t.data)})})});var n}},U=function(e){return function(t,n){if(e)return t(function(e){return{type:"SET_CURRENT_SCRIPT",payload:e}}(e))}},F=function(){return function(e){return e({type:"REQUEST_SEQUENCES"}),fetch("/sequences",{headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){return e(function(e){return{type:"RECEIVE_SEQUENCES",payload:e}}((n=t.data,Object(l.a)(n,E))));var n})}},L=function(e){return function(e,t){if(!(n=t()).sequenceData.getIn(["loading","sequence"])&&!b(n))return e(F());var n}},P=Object(o.d)({loading:!1}),Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_SEQUENCES":return e.set("loading",!0);case"RECEIVE_SEQUENCES":return e.set("loading",!1).mergeDeep(Object(o.d)(t.payload.entities));default:return e}},M=Object(o.d)({loading:!1,currentScript:null});var V,H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_SCRIPT":return e.set("currentScript",t.payload);case"REQUEST_SCRIPTS":return e.set("loading",!0);case"RECEIVE_SCRIPTS":return e.set("loading",!1).mergeDeep(Object(o.d)(t.payload.entities));case"ADD_SEQUENCE_TO_SCRIPT":return function(e,t){var n=t.index,r=t.sequence,a=t.script,c=e.getIn(["scripts",a.toString(),"sequences"]).insert(n,r);return e.setIn(["scripts",a.toString(),"sequences"],c)}(e,t.payload);case"REMOVE_SEQUENCE_FROM_SCRIPT":return function(e,t){var n=t.index,r=t.script;return e.removeIn(["scripts",r.toString(),"sequences",n])}(e,t.payload);case"CHANGE_SCRIPT_DATA":return function(e,t){var n=t.script,r=t.field,a=t.value;return e.setIn(["scripts",n.toString(),r],a)}(e,t.payload);default:return e}},X=n(100),z={characters:Object(X.a)({},{ids:[],exclude:!1},{and:!0}),types:{ids:[],exclude:!1},locations:{ids:[],exclude:!1}},B=Object(o.d)(z),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER_IDS":var n=Object(o.b)(t.payload.value);return e.setIn([t.payload.name,t.payload.field],n);case"SET_FILTER_EXCLUDE":case"SET_FILTER_AND":return e.mergeDeep(Object(s.a)({},t.payload.name,Object(s.a)({},t.payload.field,t.payload.value)));default:return e}},G=Object(i.combineReducers)((V={},Object(s.a)(V,"sequenceData",Q),Object(s.a)(V,"sequenceFilters",J),Object(s.a)(V,"scriptData",H),V)),W=n(9),K=n(264),Y=n(266),Z=n(13),$=n(14),ee=n(17),te=n(15),ne=n(16),re=n(260),ae=n(53),ce=function(e){return function(t){var n=Object.entries(t).reduce(function(e,t){return e[t[0]]=o.a.isIterable(t[1])?t[1].toJS():t[1],e},{});return a.a.createElement(e,n)}},ie=n(268),ue=n(265),se=Object(W.b)(null,function(e,t){return{saveName:function(n){return e((r=t.id,a=n,function(e,t){e(w(r,"name",a))}));var r,a}}})(ce(function(e){var t=e.name,n=(e.id,e.saveName),c=Object(r.useState)(!1),i=Object(ae.a)(c,2),u=i[0],s=i[1];return a.a.createElement("div",{className:"ScriptName"},u&&a.a.createElement(ie.a,{className:"mb-3"},a.a.createElement(ue.a,{placeholder:"Script's name","aria-label":"Script's name","aria-describedby":"basic-addon2",defaultValue:t,onBlur:function(e){n(e.currentTarget.value),s(!1)}})),!u&&a.a.createElement("h3",{onClick:function(){return s(!0)}},t))})),oe=Object(W.b)(null,function(e,t){return{saveAuthor:function(n){return e((r=t.id,a=n,function(e,t){e(w(r,"author",a))}));var r,a}}})(ce(function(e){var t=e.author,n=(e.id,e.saveAuthor),c=Object(r.useState)(!1),i=Object(ae.a)(c,2),u=i[0],s=i[1];return a.a.createElement("div",{className:"ScriptName"},u&&a.a.createElement(ie.a,{className:"mb-3"},a.a.createElement(ue.a,{placeholder:"Script's author","aria-label":"Script's author","aria-describedby":"basic-addon2",defaultValue:t,onBlur:function(e){n(e.currentTarget.value),s(!1)}})),!u&&a.a.createElement("div",{onClick:function(){return s(!0)}},t))})),le=function(e){var t=e.name,n=e.author,r=e.id;return a.a.createElement(re.a,{className:"ScriptHeaderView"},a.a.createElement(se,{name:t,id:r}),a.a.createElement(oe,{author:n,id:r}))},pe=n(261),de=function(e){var t=e.id,n=e.name,r=(Number(t)-1)%6;return a.a.createElement(pe.a,{key:t,pill:!0,variant:["danger","secondary","success","primary","warning","info","light","dark"][r]},n)},me=function(e){var t=e.characters;return a.a.createElement("div",{className:"charactersList light"},t.map(function(e,t){return a.a.createElement(de,Object.assign({key:t},e))}))},fe=function(e){var t=e.type,n=(e.name,e.characters),r=e.extra,c=e.content,i="";"dialogue"===t&&(i+=n[0].name),r&&(i+=" ".concat(r));var u="partContent";return"observation"===t&&(u+=" light"),a.a.createElement("div",{className:"partContainer"},i&&i.length>0&&a.a.createElement("div",{className:"partHeader"},i),a.a.createElement("div",{className:u},c))},Ee=function(e){var t=e.parts;return a.a.createElement("div",{className:"partsContanier"},t.map(function(e,t){return a.a.createElement(fe,Object.assign({key:t},e))}))},ge=function(e){var t=e.type,n=e.location,r=e.id,c=e.characters,i=e.parts;return a.a.createElement("div",{className:"SequenceContainer"},a.a.createElement("div",{className:"SequenceTitle"},t.name," - ",n.name," ",a.a.createElement("span",{className:"light"},"#",r)),c&&c.length>0&&a.a.createElement("div",{className:"charactersList light"},a.a.createElement(me,{characters:c})),a.a.createElement("div",{className:"partsContanier"},a.a.createElement(Ee,{parts:i})))},he=function(e){var t=e.sequences,n="Screenplay";return e.reduced&&(n+=" reduced"),a.a.createElement("div",{className:n},t&&t.map(function(e,t){return a.a.createElement(ge,Object.assign({key:t},e))}))},ve=n(262),be=n(263),Se=(n(72),function(e){function t(){return Object(Z.a)(this,t),Object(ee.a)(this,Object(te.a)(t).apply(this,arguments))}return Object(ne.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchScripts(),this.props.fetchSequences(),this.props.setScript()}},{key:"render",value:function(){return a.a.createElement("div",{className:"scriptView"},a.a.createElement(be.a,null,a.a.createElement(ve.a,{to:"/"},"Home")),this.props.script&&a.a.createElement("div",null,a.a.createElement(le,this.props.script),a.a.createElement("div",{className:"scriptEditorSequencesContainer"},a.a.createElement("section",{className:"scriptContainer"},this.props.script&&this.props.script.sequences.length&&a.a.createElement(he,{sequences:this.props.script.sequences,reduced:!1})))))}}]),t}(r.Component)),ye=Object(W.b)(function(e,t){return{script:_(e)}},function(e,t){return{fetchScripts:function(){return e(A())},fetchSequences:function(){return e(L())},setScript:function(){return e(U(t.match.params.id))}}})(ce(Se)),Oe=n(32),je=n(105),Ce=n.n(je),qe={beginDrag:function(e){return console.log(e),{seqId:e.sequence.id}}};var Ne=Object(Oe.DragSource)("sequence",qe,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(function(e){var t=e.connectDragSource,n=(e.isDragging,e.sequence);return t(a.a.createElement("div",{className:"dragContainer"},a.a.createElement(ge,Object.assign({key:n.id},n))))}),Te=function(e){var t=e.sequences;return a.a.createElement("div",{className:"Screenplay reduced"},t&&t.map(function(e,t){return a.a.createElement(Ne,{key:t,sequence:e})}))},De=n(112),ke=function(e){var t=e.filter,n=e.items,r=e.onChangeIds;return a.a.createElement(De.a,{isMulti:"true",value:Ie(n,t.ids),onChange:function(e){return r(e.map(function(e){return e.value}))},options:_e(n)})},Ie=function(e,t){if(t&&t.length)return t.map(function(t){return Re(e[t.toString()])})},_e=function(e){if(e&&Object.keys(e).length)return Object.keys(e).map(function(t){return Re(e[t])})},Re=function(e){return{label:e.name,value:e.id}},xe=function(e){var t=e.filter,n=e.field,r=e.onChange;return a.a.createElement("label",{className:"btn btn-default"},a.a.createElement("input",{type:"checkbox",name:n,id:n,value:"true",checked:t[n],onChange:function(e){return r(e.currentTarget.checked)}}),n)},we=Object(W.b)(function(e,t){return{items:T(e,t.name),filter:D(e,t.name)}},function(e,t){return{onChangeIds:function(n){e(function(e,t){return{type:"SET_FILTER_IDS",payload:{name:e,field:"ids",value:t}}}(t.name,n))},onChangeExclude:function(n){e(function(e,t){return{type:"SET_FILTER_EXCLUDE",payload:{name:e,field:"exclude",value:t}}}(t.name,n))},onChangeAnd:function(n){e(function(e,t){return{type:"SET_FILTER_EXCLUDE",payload:{name:e,field:"and",value:t}}}(t.name,n))}}})(ce(function(e){var t=e.filter;return a.a.createElement("div",{className:"FilterContainer"},a.a.createElement("div",{className:"FilterTitle"},e.name),a.a.createElement(ke,e),t.ids&&t.ids.length>0&&a.a.createElement("div",{className:"btn-group"},a.a.createElement(xe,{filter:t,field:"exclude",onChange:e.onChangeExclude}),Object.keys(t).includes("and")&&t.ids.length>1&&a.a.createElement(xe,{filter:t,field:"and",onChange:e.onChangeAnd})))})),Ae=function(e){return a.a.createElement("section",{className:"FiltersContainer"},a.a.createElement(we,{name:"characters",key:1}),a.a.createElement(we,{name:"types",key:2}),a.a.createElement(we,{name:"locations",key:3}))},Ue=function(e){function t(){return Object(Z.a)(this,t),Object(ee.a)(this,Object(te.a)(t).apply(this,arguments))}return Object(ne.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSequences()}},{key:"render",value:function(){return a.a.createElement("div",{className:"ScreenplayContainer"},a.a.createElement(Ae,null),a.a.createElement(Te,{sequences:this.props.sequences}))}}]),t}(r.Component),Fe=Object(W.b)(function(e,t){return{sequences:I(e)}},function(e,t){return{fetchSequences:function(){return e(L())}}})(ce(Ue)),Le=Object(W.b)(function(e,t){return{script:q(e)}},function(e,t){return{deleteSequence:function(t,n){return e(function(e,t){return{type:"REMOVE_SEQUENCE_FROM_SCRIPT",payload:{index:t,script:e}}}(t,n))}}})(ce(function(e){var t=e.sequence,n=e.deleteSequence,r=e.index,c=e.script;return a.a.createElement("div",{className:"sequenceWrapper"},a.a.createElement("button",{className:"deleteSequence",onClick:function(){return n(c,r)}},"X"),a.a.createElement(ge,Object.assign({key:r},t)))}));var Pe=function(e){function t(){return Object(Z.a)(this,t),Object(ee.a)(this,Object(te.a)(t).apply(this,arguments))}return Object(ne.a)(t,e),Object($.a)(t,[{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.isOver?"droparea over":"droparea";return t(a.a.createElement("div",{className:n}))}}]),t}(r.Component),Qe=Object(Oe.DropTarget)("sequence",{drop:function(e,t,n){e.index,n.props.includeSequence(t.getItem().seqId,n.props.script,n.props.index)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})(Pe),Me=Object(W.b)(function(e,t){return{script:q(e)}},function(e,t){return{includeSequence:function(t,n,r){e(function(e,t,n){return{type:"ADD_SEQUENCE_TO_SCRIPT",payload:{index:n,sequence:t,script:e}}}(n,t,r))}}})(Qe),Ve=function(e){var t=e.sequences;return a.a.createElement("div",{className:"Screenplay reduced"},t&&t.map(function(e,t){return a.a.createElement("div",{key:t},a.a.createElement(Me,{index:t}),a.a.createElement(Le,{sequence:e,index:t}))}),a.a.createElement(Me,{index:t.length}))},He=function(e){function t(){return Object(Z.a)(this,t),Object(ee.a)(this,Object(te.a)(t).apply(this,arguments))}return Object(ne.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchScripts(),this.props.fetchSequences(),this.props.setScript(),this.props.copyConsistentScript()}},{key:"render",value:function(){return a.a.createElement("div",{className:"scriptView"},a.a.createElement(be.a,null,a.a.createElement(ve.a,{to:"/"},"Home")),this.props.script&&a.a.createElement("div",null,a.a.createElement(le,this.props.script),a.a.createElement("div",{className:"scriptEditorSequencesContainer"},a.a.createElement("section",{className:"sequencePicker"},a.a.createElement(Fe,null)),a.a.createElement("section",{className:"scriptContainer"},this.props.script&&this.props.script.sequences.length&&a.a.createElement(Ve,{sequences:this.props.script.sequences})))))}}]),t}(r.Component),Xe=Object(Oe.DragDropContext)(Ce.a)(Object(W.b)(function(e,t){return{script:_(e)}},function(e,t){return{fetchScripts:function(){return e(A())},fetchSequences:function(){return e(L())},setScript:function(){return e(U(t.match.params.id))},copyConsistentScript:function(){return console.log("dispatch action to store consistent script")}}})(ce(He))),ze=function(e){var t=e.name,n=e.sequences,r=(e.id,e.author);return a.a.createElement("div",{className:"ScriptCardContainer"},a.a.createElement("h3",{className:"ScriptCardTile"},t),a.a.createElement("div",{className:"ScriptCardInfo"},a.a.createElement("div",{className:"ScriptCardAuthorContainer"},a.a.createElement("span",null,"author "),a.a.createElement("span",{className:"label label-default"},r)),a.a.createElement("div",{className:"ScriptCardSequenceCount"},a.a.createElement("span",null,n.length," ",1===n.length?"sequence":"sequences"))))},Be=n(267),Je=function(e){function t(){return Object(Z.a)(this,t),Object(ee.a)(this,Object(te.a)(t).apply(this,arguments))}return Object(ne.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchScripts()}},{key:"render",value:function(){var e=this;return a.a.createElement(Be.a,null,this.props.scripts&&Object.keys(this.props.scripts).map(function(t){return a.a.createElement(Be.a.Item,{key:t},a.a.createElement(ve.a,{to:"".concat(t,"/edit")},a.a.createElement(ze,Object.assign({key:t},e.props.scripts[t],{onClick:e.props.onClick}))))}))}}]),t}(r.Component),Ge=Object(W.b)(function(e,t){return{scripts:C(e)}},function(e,t){return{fetchScripts:function(){return e(A())}}})(ce(Je)),We=(n(257),function(){return a.a.createElement("div",{className:"Home"},a.a.createElement("h1",null,"List of Scripts"),a.a.createElement(Ge,null))}),Ke=function(e){var t=e.store;return a.a.createElement(W.a,{store:t},a.a.createElement(K.a,null,a.a.createElement("div",null,a.a.createElement(Y.a,{exact:!0,path:"/",component:We}),a.a.createElement(Y.a,{exact:!0,path:"/new",component:ye}),a.a.createElement(Y.a,{exact:!0,path:"/:id/edit",component:Xe}),a.a.createElement(Y.a,{exact:!0,path:"/:id",component:ye}))))},Ye=[u.a];var Ze=Object(i.createStore)(G,i.applyMiddleware.apply(void 0,Ye));Object(c.render)(a.a.createElement(Ke,{store:Ze}),document.getElementById("root"))},72:function(e,t,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.e2d95414.chunk.js.map